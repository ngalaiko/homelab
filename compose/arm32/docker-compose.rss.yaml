version: '3.4'

volumes:
    postgres_data:

services:
    postgres:
        image: ngalayko/postgres:arm32v7
        environment:
            - POSTGRES_PASSWORD=${POSTGRES_PASS}
        volumes:
            - postgres_data:/var/lib/postgresql/data
        deploy:
            replicas: 1
            restart_policy:
                condition: on-failure
            resources:
                limits:
                    memory: 128M
                reservations:
                    memory: 64M
            placement:
                constraints:
                    - "node.labels.postgres==true"
